# ECMA

## JavaScript 概念

JavaScript 由三部分组成：

- 文档对象模型 (DOM) - document object mode(W3C 规范)
- 浏览器对象模型(BOM) - browser object model(没有规范)
- ECMAScript

ECMAScript包含语法，变量，关键字，保留字，值，原始类型，引用类型，运算，对象，继承，函数。



## 线程

JavaScript引擎是单线程，它可以模拟多线程，如单线程的机制是轮转时间片，短时间内轮流执行多个任务的片段。

1. 任务 1，任务 2
2. 切分任务 1，任务 2
3. 随机排列这些任务片段，组成队列
4. 按照这个队列顺序将任务片段送进 `JS `进程
5. `JS `线程执行一个又一个的任务片段



## 脚本引入

HTML `<script>` 元素用于嵌入或引用可执行脚本。它可以引入外部文件或者内部脚本代码块。

```
//外部文件
<script type="text/javascript" src="js/index.js"></script>
```

```
//内部脚本
<script type="text/javascript">
  document.write('I am a inner JS');
</script>
```

`<script>`标签里可以定义不同的属性，如`type`，`async`，`src`，`defer`，`crossorigin`等。

- `src`这个属性定义引用外部脚本的 URI，这可以用来代替直接在文档中嵌入脚本。指定了 src 属性的 script 元素标签内不应该再有嵌入的脚本。
- `type`属性定义`src`引用的脚本语言，如`text/javascript`，`application/javascript`，`text/tpl`定义错误的目的是可以使其标签脚本不执行，仅用来做模板文件使用。
- `async`属性可以使脚本文件异步执行，且同时解析文档加载。
- `defer`属性通知浏览器该脚本将在文档完成解析后，触发 `DOMContentLoaded ()` 事件前执行。 有 `defer` 属性的脚本会阻止 `DOMContentLoaded` 事件，直到脚本被加载并且解析完成。
- `crossorigin`属性可以使用本属性来使那些将静态资源放在另外一个域名的站点打印错误信息。





## 变量

一个变量，就是一个用于存放数值的容器。声明变量 `var`有两个过程，第一个是变量声明，第二个是变量赋值。

```
var a; //声明变量a
a = 3; //变量赋值
var a = 3; //变量声明并赋值
```

```
//单一声明
var x = 1,
    y = 2;
```



**企业开发命名规范：**

- 不能以数字开头
- 能字母 `_`, `$`开头
- 字母`_`,`$`数字
- 不能关键字
- 不能保留字
- 语义化
- 结构化(`js_header js-header`)
- 小驼峰
- 英语写法
- 避免拼音



**变量的优先级问题：**

```
//运算 > 赋值
var x = 3,
    y = 4;

var z = x + y;
console.log(z);

//print
7
```

## JS 值

JavaScript 语言是动态语言也是脚本语言也是解释型语言也是弱类型语言(根据值的类型成为被赋值的变量)。Java 语言是静态语言也是编译型语言也是强类型语言。

## 原始值

基本变量类型有`Number`，`String`，`Boolean`，`undefined`，`null`。

**Number**

```
var a = 1;
var a = 3.14;
```

**String**

```
var str = 'i love programing';
```

**Boolean**，布尔值(布尔发明)，计算机里，非真即假，非假即真。

```
var a = true;
console.log(a);
//true
```

**undefined**

1. 系统会给一个未赋值的变量自动赋值为`undefined`，类型也是`undefined`
2. 函数没有传入实参时，参数为`undefined`
3. 函数没有返回值时，默认返回`undefined`

```
var a = undefined;
console.log(a);
//undefined
```

```
var a;
console.log(a);
//undefined
```

- `undefined`既是一个原始数据类型，也是一个原始值数据
- `undefined`是全局对象上的一个属性`window.undefined`
- `undefined`不可写`writable: false`
- `undefined`不可配置`configurable: false`
- `undefined`不可枚举`enumerable: false`
- `undefined`不可重新定义`defineProperty`
- 全局下，`undefined`无法作为一个变量使用
- 局部作用域下，`undefined`可以作为一个变量使用，说明`undefined`不是 JS 的保留字和关键字

> **注**：`void(0) === undefined`





**null**，空值，它的作用在于初始化组件和销毁函数。

## 引用值

引用值有`object`，`array`，`function`，`date`，`RegExp`等。

## 内存

JavaScript中的内存分为栈内存 `Stack`和堆内存 `Heap`。

**如何存储原始值？**

栈内存先进后出

```
var a = 3;
var b = a;
a = 1;
console.log(b); //3
```

**存储步骤：**

1. 往内存空间最里面声明变量 a 并在空间里存入值 3(`var a = 3`)
2. 往内存空间最里面的上一位声明变量 b 并在空间里存入值 3(`var b = a`)
3. 往内存空间最里面的上上一位开辟空间里存入值 1(`a = 1`)

说明原始值数据是永久保存且不可改变的，例如手机相机电脑内存删除内容其实数据仍保留。



**如何存储引用值？**

值，指针存储在栈 `Stack `内存 指向 堆内存 `Heap `地址

```
var arr1 = [1, 2, 3, 4];
var arr2 = arr1;
console.log(arr1 + '' + arr2);
//1, 2, 3, 4 | 1, 2, 3, 4
```

指向相同地址的情况：

```
var arr1 = [1, 2, 3, 4];
var arr2 = arr1;
arr1.push(5);
console.log(arr1); //1, 2, 3, 4, 5
console.log(arr2); //1, 2, 3, 4, 5
```

指向不同地址的情况：

```
var arr1 = [1, 2, 3, 4];
var arr2 = arr1;

arr1 = [1, 2];

console.log(arr1); //1, 2
console.log(arr2); //1, 2, 3, 4, 5
```

